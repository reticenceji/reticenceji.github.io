<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>File System - Reticence&#x27;s Notes</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../../index.html">Index</a></li><li class="chapter-item expanded "><a href="../../../Advanced/index.html">Advanced</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/index.html">Block Chain</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/index.html">区块链技术</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/Consensus.html">共识机制</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/Crypto.html">加密</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/Distribute.html">分布式存储</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/P2P.html">P2P</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Basic/SmartContract.html">如何执行智能合约</a></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/index.html">DeFi</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/DAO.html">Decentralized Autonomous Organization</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/Derivative.html">Decentralized Derivative</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/Exchange.html">Decentralized Exchange</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/FundManagement.html">Decentralized Fund Management</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/Insurance.html">Decentralized Insurance</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/LendBorrow.html">Decentralized Lending & Borrowing</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/Lottery.html">Decentralized Lottery</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/Payments.html">Decentralized Payments</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Defi/StableCoin.html">Stable Coins</a></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/Ethernet/index.html">Ethernet</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/Ethernet/Solidity.html">Solidity简介</a></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/index.html">Hello NEAR</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/PoS.html">Proof-of-Stake</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/Promise.html">异步模型</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/Secure.html">Secure</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/Snippets.html">Snippets</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/Standards.html">标准实现代码分析</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/dao.html">dao</a></li><li class="chapter-item "><a href="../../../Advanced/Blockchain/NEAR/wasm.html">wasm</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../Advanced/Linux/index.html">Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Advanced/Linux/LinuxKernel/index.html">Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/Credential.html">Credential</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/Debug笔记.html">Debug笔记</a></li><li class="chapter-item expanded "><a href="../../../Advanced/Linux/LinuxKernel/File_System.html" class="active">File System</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/Linux内核设计与实现笔记.html">《Linux内核设计与实现》笔记</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/Linux设备驱动笔记.html">《Linux设备驱动》笔记</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/RCU.html">RCU</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/Rust_for_linux.html">Rust for linux</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/System_Call.html">System Call</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/context_switch.html">进程调度时的context_switch</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/内核编程笔记.html">Linux内核编程笔记</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/数据结构.html">数据结构</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/调试Linux内核环境搭建.html">调试Linux内核环境搭建</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxKernel/调试时如何获取current.html">调试Linux内核，寻找current</a></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxPlay/index.html">LinuxPlay</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxPlay/Linux使用笔记.html">Linux使用笔记</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxPlay/使用SSH远程登录.html">Linux使用SSH远程登录</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxPlay/在Linux中找到可用的网络接口.html">在Linux中找到可用的网络接口</a></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/index.html">Linux Program</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/Deamon.html">Daemon</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/Fanotify.html">Fanotify</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/File.html">File Program</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/IObound.html">I/O bound 程序优化</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/Linux目录结构.html">Linux目录结构</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/NetLink.html">Netlink</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/Socket.html">Socket</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/eBPF.html">eBPF</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/prctl.html">进程</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/信号.html">信号</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/共享库.html">共享库</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/凭证.html">Credential 凭证</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/反向Shell和伪终端.html">反向Shell和伪终端</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/性能监控.html">性能监控</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/桌面应用开发.html">桌面应用开发</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/管道和重定向.html">管道和重定向</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/系统限制和选项.html">系统限制和选项</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/终端.html">终端</a></li><li class="chapter-item "><a href="../../../Advanced/Linux/LinuxProgram/进程间通信.html">进程间通信</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../Advanced/Windows/index.html">Windows Programming</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Advanced/Windows/Unicode.html">Unicode</a></li><li class="chapter-item "><a href="../../../Advanced/Windows/hungarian.html">匈牙利命名法</a></li><li class="chapter-item "><a href="../../../Advanced/Windows/文件.html">文件</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../Basic/index.html">Basic</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/8086汇编笔记.html">8086汇编笔记</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/index.html">Architecture</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Architecture/ARM内存管理.html">AArch64 memory management</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/ARM寄存器.html">ARM中的寄存器</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/ARM异常.html">AArch64 Exception Model</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/ARM虚拟化.html">Armv8-A virtualization</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/ARM调试.html">ARM self-hosted debug</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/CPU设计.html">CPU设计</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/Cache.html">Cache</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/ILP.html">ILP</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/SIMD和MIMD.html">SIMD和MIMD</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/TLP.html">TLP</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/存储器设计.html">存储器设计</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/数字逻辑.html">Notes-数字逻辑</a></li><li class="chapter-item "><a href="../../../Basic/Architecture/计算机体系结构.html">计算机组成&计算机体系结构</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/C/index.html">C/C++</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/C/Cpp标准库.html">C++_标准库</a></li><li class="chapter-item "><a href="../../../Basic/C/Cpp课程笔记.html">C++ 基础知识</a></li><li class="chapter-item "><a href="../../../Basic/C/GCC内嵌汇编.html">C-内嵌汇编</a></li><li class="chapter-item "><a href="../../../Basic/C/变量在ELF段中的位置.html">变量在ELF段中的位置</a></li><li class="chapter-item "><a href="../../../Basic/C/可变参数的使用和原理.html">可变参数的使用和原理</a></li><li class="chapter-item "><a href="../../../Basic/C/在C程序中调用汇编程序.html">在C程序中调用汇编程序</a></li><li class="chapter-item "><a href="../../../Basic/C/链接器.html">链接器</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Client/index.html">Client Development</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Client/Chromium.html">Chromium</a></li><li class="chapter-item "><a href="../../../Basic/Client/CodeReview.html">CodeReview</a></li><li class="chapter-item "><a href="../../../Basic/Client/Config.html">Config</a></li><li class="chapter-item "><a href="../../../Basic/Client/CrossLanguage.html">跨语言</a></li><li class="chapter-item "><a href="../../../Basic/Client/DataStore.html">本地存储</a></li><li class="chapter-item "><a href="../../../Basic/Client/Database.html">Database</a></li><li class="chapter-item "><a href="../../../Basic/Client/Flutter.html">Flutter</a></li><li class="chapter-item "><a href="../../../Basic/Client/Log.html">日志</a></li><li class="chapter-item "><a href="../../../Basic/Client/Multimedia/index.html">Multimedia</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Client/Multimedia/Graph.html">图形学</a></li><li class="chapter-item "><a href="../../../Basic/Client/Multimedia/Image.html">图像处理技术</a></li><li class="chapter-item "><a href="../../../Basic/Client/Multimedia/Video.html">视频</a></li><li class="chapter-item "><a href="../../../Basic/Client/Multimedia/Voice.html">Voice</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Client/Network.html">网络能力</a></li><li class="chapter-item "><a href="../../../Basic/Client/Performance.html">性能监控</a></li><li class="chapter-item "><a href="../../../Basic/Client/Platform/index.html">Platform</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Client/Platform/Android.html">Android</a></li><li class="chapter-item "><a href="../../../Basic/Client/Platform/iOS.html">iOS</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Client/SQLite.html">SQLite</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Compiler/index.html">Compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Compiler/Codegen.html">代码生成</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/Lex.html">Lex</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/Lexical.html">Lexical Analyze</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/Runtime.html">Runtime</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/Sematic.html">Sematic Analyzing</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/Syntax.html">Syntax Analyzer</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/llvm-ir.html">LLVM-IR</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/llvm.html">LLVM</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/pest.html">PEST</a></li><li class="chapter-item "><a href="../../../Basic/Compiler/yacc.html">Yacc</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/index.html">Data Structure And Algorithm</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/index.html">Algorithm</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Approximation.html">近似算法</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Backtracking.html">递归回溯</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/DivideAndConquer.html">分治算法</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/DynamicProgramming.html">动态规划</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Greedy.html">贪心算法</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/LocalSearch.html">本地搜索</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Parallel.html">并行算法</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Randomized.html">随机化算法</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Algorithm/Sort.html">排序算法</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/index.html">Graph</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/Bipartite.html">Bipartite</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/NetworkFlow.html">NetworkFlow</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/ShortPath.html">最短路</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/SpanningTree.html">最小生成树</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/关键路径.html">关键路径</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Graph/拓扑排序.html">拓扑排序</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Hash/index.html">Hash</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Hash/HashTree.html">HashTree</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Hash/Hashing.html">Hashing</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Heap/index.html">Heap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Heap/BinomialHeap.html">Binomial Heap</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Heap/FibonacciHeap.html">FibonacciHeap</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Heap/Heap.html">DS-Heap</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Heap/斜堆.html">Leftist_Heap_and_Skew_Heap</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Inverted_File_Index.html">Inverted_File_Index</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Linear/index.html">Linear</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Linear/Bitmap.html">DS-Bitmap</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Linear/List.html">DS-Linear_List</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/NPProblem.html">DS-NP_problem</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/String/index.html">字符串匹配相关算法</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/String/match.html">字符串匹配算法</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/index.html">Tree and BST</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/BTree.html">B Tree and B+ Tree</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/BalancedTree.html">AVL Tree and Splay Tree</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/DisjointSet.html">Disjoint Set</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/HuffmanTree.html">Huffman Tree</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/RBTree.html">红黑树 B树 B+树</a></li><li class="chapter-item "><a href="../../../Basic/DataStructure/Tree/ThreadedTree.html">Threaded Binary Tree</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../Basic/Database/index.html">Database</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Database/Object.html">Database-Object-Based_Databases</a></li><li class="chapter-item "><a href="../../../Basic/Database/PostgreSQL-Conflict-reticenceji_Win10.html">Database-PostgreSQL</a></li><li class="chapter-item "><a href="../../../Basic/Database/PostgreSQL.html">Database-PostgreSQL</a></li><li class="chapter-item "><a href="../../../Basic/Database/SQL-Conflict-reticenceji_Win10.html">基础SQL</a></li><li class="chapter-item "><a href="../../../Basic/Database/SQL.html">基础SQL</a></li><li class="chapter-item "><a href="../../../Basic/Database/XML-Conflict-reticenceji_Win10.html">Database,Web-XML</a></li><li class="chapter-item "><a href="../../../Basic/Database/XML.html">Database,Web-XML</a></li><li class="chapter-item "><a href="../../../Basic/Database/事务.html">Database-事务</a></li><li class="chapter-item "><a href="../../../Basic/Database/关系代数.html">Database-关系代数</a></li><li class="chapter-item "><a href="../../../Basic/Database/存储和查询.html">Database-存储和查询</a></li><li class="chapter-item "><a href="../../../Basic/Database/导论.html">Database-导论</a></li><li class="chapter-item "><a href="../../../Basic/Database/数据库设计.html">Database-数据库设计</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Maths/index.html">Maths</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Maths/大数定理和中心极限定理.html">大数定理和中心极限定理</a></li><li class="chapter-item "><a href="../../../Basic/Maths/微积分下.html">微积分下</a></li><li class="chapter-item "><a href="../../../Basic/Maths/数值计算方法.html">数值计算方法</a></li><li class="chapter-item "><a href="../../../Basic/Maths/最小二乘法.html">最小二乘法</a></li><li class="chapter-item "><a href="../../../Basic/Maths/有限自动机介绍.html">有限自动机介绍</a></li><li class="chapter-item "><a href="../../../Basic/Maths/概统复习.html">概统复习</a></li><li class="chapter-item "><a href="../../../Basic/Maths/群论简介.html">群论简介</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Networking/index.html">Networking</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Networking/ARP.html">Networking-ARP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/CDN.html">CDN</a></li><li class="chapter-item "><a href="../../../Basic/Networking/DNS.html">DNS</a></li><li class="chapter-item "><a href="../../../Basic/Networking/FTP.html">FTP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/HTTP.html">HTTP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/ICMP.html">Internet Control Message Protocol</a></li><li class="chapter-item "><a href="../../../Basic/Networking/Mail.html">邮件协议</a></li><li class="chapter-item "><a href="../../../Basic/Networking/NAT.html">Network Address Translation</a></li><li class="chapter-item "><a href="../../../Basic/Networking/P2P.html">P2P</a></li><li class="chapter-item "><a href="../../../Basic/Networking/QUIC.html">QUIC</a></li><li class="chapter-item "><a href="../../../Basic/Networking/RTC.html">RTC</a></li><li class="chapter-item "><a href="../../../Basic/Networking/Socket.html">Socket</a></li><li class="chapter-item "><a href="../../../Basic/Networking/TCP.html">TCP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/UDP.html">UDP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/VMWare虚拟机网络配置.html">VMWare虚拟机网络配置</a></li><li class="chapter-item "><a href="../../../Basic/Networking/VPN.html">VPN</a></li><li class="chapter-item "><a href="../../../Basic/Networking/WebSocket.html">WebSocket</a></li><li class="chapter-item "><a href="../../../Basic/Networking/介质访问子层.html">Medium Access Sublayer</a></li><li class="chapter-item "><a href="../../../Basic/Networking/可靠传输.html">可靠传输</a></li><li class="chapter-item "><a href="../../../Basic/Networking/差错控制.html">差错控制</a></li><li class="chapter-item "><a href="../../../Basic/Networking/拥塞控制和流量控制.html">拥塞控制和流量控制</a></li><li class="chapter-item "><a href="../../../Basic/Networking/物理层.html">物理层</a></li><li class="chapter-item "><a href="../../../Basic/Networking/网络层.html">网络层 IP</a></li><li class="chapter-item "><a href="../../../Basic/Networking/网络设备.html">Networking-网络设备</a></li><li class="chapter-item "><a href="../../../Basic/Networking/路由协议.html">路由协议</a></li><li class="chapter-item "><a href="../../../Basic/Networking/链路层.html">链路层</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/OS/index.html">OS</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/OS/Bootloader.html">OS-Bootloader</a></li><li class="chapter-item "><a href="../../../Basic/OS/Buddy_System&Slub.html">OS-Buddy_System&Slub</a></li><li class="chapter-item "><a href="../../../Basic/OS/Deadlock.html">OS-Deadlock</a></li><li class="chapter-item "><a href="../../../Basic/OS/IO.html">OS-IO</a></li><li class="chapter-item "><a href="../../../Basic/OS/Introduction.html">OS-Introduction</a></li><li class="chapter-item "><a href="../../../Basic/OS/Memory_Management.html">OS-Memory_Management</a></li><li class="chapter-item "><a href="../../../Basic/OS/Process.html">OS-Process</a></li><li class="chapter-item "><a href="../../../Basic/OS/Q&A.html">OS-Q&A</a></li><li class="chapter-item "><a href="../../../Basic/OS/RISCV学习笔记.html">OS-RISCV学习笔记</a></li><li class="chapter-item "><a href="../../../Basic/OS/SBI.html">OS-SBI</a></li><li class="chapter-item "><a href="../../../Basic/OS/Synchronization.html">OS-Synchronization</a></li><li class="chapter-item "><a href="../../../Basic/OS/Thread.html">OS-Thread</a></li><li class="chapter-item "><a href="../../../Basic/OS/UnixLinux中的IO模型.html">Linux中的I/O模型</a></li><li class="chapter-item "><a href="../../../Basic/OS/在K210运行裸机程序.html">OS-在K210运行裸机程序</a></li><li class="chapter-item "><a href="../../../Basic/OS/地址空间(一).html">OS-地址空间(一)</a></li><li class="chapter-item "><a href="../../../Basic/OS/操作系统.html">OS-操作系统</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Secure/index.html">Secure</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/index.html">Crypto</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/Federated_Learning.html">Federated Learning</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/Oblivious_RAM.html">Oblivious RAM</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/PIR.html">PIR</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/PSI.html">Private set intersection</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/加密和哈希.html">Crypto-加密和哈希</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/加密数据库.html">Encrypted Database</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/区块链技术.html">Bitcoin-区块链技术</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/可证明安全.html">可证明安全</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/安全多方计算.html">安全多方计算</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/密码学基础.html">密码学算法介绍</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/密码学进阶.html">密码学进阶</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Crypto/差分隐私.html">差分隐私</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Secure/CryptoBasic.html">密码学基础</a></li><li class="chapter-item "><a href="../../../Basic/Secure/CtyptoProtocol.html">密码学协议</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/index.html">电子取证</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/FAT.html">FAT文件系统</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/FileCarving.html">文件雕复</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/Linux取证.html">Linux取证</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/Memory.html">内存取证</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/NTFS.html">NTFS文件系统</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/Windows取证.html">Windows取证</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/数据隐藏.html">数据隐藏</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/文件系统取证.html">文件系统取证</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/硬盘分析.html">硬盘分析</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/移动设备取证.html">移动设备取证</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Forensics/网络取证.html">网络取证</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Secure/IoT.html">无线与物联网安全</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Network.html">网络安全</a></li><li class="chapter-item "><a href="../../../Basic/Secure/OperatingSystem.html">操作系统安全</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/index.html">软件安全</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Basic/Secure/Software/ASLR.html">ASLR</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/CodeQL.html">CodeQL</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/GlibcHeap.html">glibc heap allocator</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/PIC.html">位置无关代码和共享库</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/RELRO.html">RELRO</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/pwntools.html">pwntools</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/攻击视角.html">攻击软件安全</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/程序分析.html">程序分析</a></li><li class="chapter-item "><a href="../../../Basic/Secure/Software/防御视角.html">软件安全防护</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/Secure/SupplyChain.html">供应链安全</a></li></ol></li><li class="chapter-item "><a href="../../../Basic/软件保护技术.html">Reverse</a></li></ol></li><li class="chapter-item "><a href="../../../Language/index.html">Language</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Java/index.html">Java</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Java/基础.html">Java</a></li><li class="chapter-item "><a href="../../../Language/Java/鸿蒙应用开发.html">Java-鸿蒙应用开发</a></li></ol></li><li class="chapter-item "><a href="../../../Language/JavaScript/index.html">JavaScript</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/JavaScript/Electron.html">Electron</a></li><li class="chapter-item "><a href="../../../Language/JavaScript/JavaScript简介.html">JavaScript简介</a></li><li class="chapter-item "><a href="../../../Language/JavaScript/Runtime.html">Runtime</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Python/index.html">Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Python/0内置类型/index.html">内置对象</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Python/0内置类型/1字符串.html">字符串和字节串</a></li><li class="chapter-item "><a href="../../../Language/Python/0内置类型/2数值.html">数值</a></li><li class="chapter-item "><a href="../../../Language/Python/0内置类型/3列表和元组.html">序列</a></li><li class="chapter-item "><a href="../../../Language/Python/0内置类型/4字典和集合.html">映射</a></li><li class="chapter-item "><a href="../../../Language/Python/0内置类型/5迭代器和生成器.html">迭代器和生成器</a></li><li class="chapter-item "><a href="../../../Language/Python/0内置类型/6上下文管理器.html">上下文管理器</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/index.html">工作原理</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Python/1工作原理/0对象模型.html">OOP模型</a></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/1类型.html">类型</a></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/2变量.html">变量</a></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/3特殊方法和重载.html">特殊方法和重载</a></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/4参数.html">参数</a></li><li class="chapter-item "><a href="../../../Language/Python/1工作原理/5多继承.html">多继承</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Python/3高级写法/index.html">高级写法</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Python/3高级写法/1异常.html">Exception</a></li><li class="chapter-item "><a href="../../../Language/Python/3高级写法/2装饰器.html">装饰器</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/index.html">PythonLib</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Argparse.html">命令行参数</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Bisect.html">Bisect</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Builtin.html">Builtin</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Container.html">Container</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Crypto.html">Crypto</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Enum.html">enum</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/FS.html">File System</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Flask.html">Python-Flask</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/HTTP.html">Internet</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/IO.html">File IO</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/PyQt5.html">PySide2</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Regex.html">Regex</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Socket.html">Socket编程</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Thread.html">多线程</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Time.html">时间和日期</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/Trio.html">Trio</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/format.html">Format String</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/venv.html">Virtual Environment</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/数据持久化.html">简单的数据持久化</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/文档和测试.html">文档和测试</a></li><li class="chapter-item "><a href="../../../Language/Python/4好用的库/计算器.html">把Python当计算器</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Python/运算符.html">运算符</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Rust/index.html">Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Rust/Basic/index.html">Basic</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Rust/Basic/Any.html">Any</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Async.html">异步编程</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Casting.html">Casting</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/ClosureAndIter.html">迭代器和闭包</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/CratesAndModules.html">Crates and Modules</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Error.html">Rust-错误处理</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Macro.html">宏</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Trait.html">Trait</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/TypeAndLifetime.html">从类型系统看生命周期</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/Unsafe.html">Unsafe</a></li><li class="chapter-item "><a href="../../../Language/Rust/Basic/pattern.html">模式匹配</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Rust/Build.html">Build</a></li><li class="chapter-item "><a href="../../../Language/Rust/Cargo/index.html">Cargo</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Rust/Cargo/clippy.html">Clippy</a></li><li class="chapter-item "><a href="../../../Language/Rust/Cargo/fix.html">Cargo fix</a></li><li class="chapter-item "><a href="../../../Language/Rust/Cargo/make.html">Cargo make</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Rust/Compiler.html">Compiler</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/index.html">Crates</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Rust/Crate/Anyhow.html">AnyHow & ThisError</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/Cell.html">Cell</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/Diesel.html">Diesel</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/Dioxus.html">Dioxus</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/EnumDispatch.html">Dispatch</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/IO.html">IO</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/collections.html">容器的增删改查</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/gtk-rs.html">gtk-rs</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/r2d2.html">r2d2</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/stdsync.html">std::sync</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/字符串.html">字符串/字节流</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/打包.html">打包</a></li><li class="chapter-item "><a href="../../../Language/Rust/Crate/智能指针.html">Rust-智能指针</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Rust/FFI.html">FFI</a></li><li class="chapter-item "><a href="../../../Language/Rust/IO.html">Rust-IO</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/index.html">Practice</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Rust/Practice/BestPractice.html">Rust最佳实践</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Debug.html">调试</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/DesignPattern.html">设计模式</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Performance.html">性能优化</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Size.html">代码体积优化</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Test.html">测试最佳实践</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Type.html">类型转换</a></li><li class="chapter-item "><a href="../../../Language/Rust/Practice/Unsafe.html">Unsafe最佳实践</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Rust/gtk.html">Rust-gtk-rs介绍</a></li><li class="chapter-item "><a href="../../../Language/Rust/函数参数匹配.html">函数参数匹配</a></li><li class="chapter-item "><a href="../../../Language/Rust/基础知识.html">基础知识</a></li><li class="chapter-item "><a href="../../../Language/Rust/多线程.html">多线程支持</a></li><li class="chapter-item "><a href="../../../Language/Rust/混合编程.html">混合编程</a></li><li class="chapter-item "><a href="../../../Language/Rust/精髓.html">Rust-精髓</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Scala/index.html">Scala</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Scala/0控制结构.html">控制结构</a></li><li class="chapter-item "><a href="../../../Language/Scala/1数据结构.html">数据结构</a></li><li class="chapter-item "><a href="../../../Language/Scala/2_0类和对象.html">Class</a></li><li class="chapter-item "><a href="../../../Language/Scala/2_1继承.html">继承</a></li><li class="chapter-item "><a href="../../../Language/Scala/2_2特质.html">Trait</a></li><li class="chapter-item "><a href="../../../Language/Scala/3_1花里胡哨的函数.html">花里胡哨的函数</a></li><li class="chapter-item "><a href="../../../Language/Scala/3_2匿名函数和闭包.html">函数</a></li><li class="chapter-item "><a href="../../../Language/Scala/3_3模式匹配.html">模式匹配</a></li><li class="chapter-item "><a href="../../../Language/Scala/3_4容器的函数式操作.html">容器的函数式操作</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/index.html">ScalaDepth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/Class文件.html">Class文件</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/ScalaInDepth.html">Scala in Depth 读书笔记</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/Spark.html">Spark</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/jvm.html">《深入理解Java虚拟机读书》笔记</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/函数式的一些概念.html">Scala中一些函数式概念</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/泛型擦除.html">泛型擦除</a></li><li class="chapter-item "><a href="../../../Language/Scala/ScalaDepth/简单的类型原理.html">类型</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Scala/sbt.html">sbt</a></li><li class="chapter-item "><a href="../../../Language/Scala/trait.html">trait</a></li><li class="chapter-item "><a href="../../../Language/Scala/枚举.html">枚举</a></li><li class="chapter-item "><a href="../../../Language/Scala/样例类和模式匹配.html">样例类和模式匹配</a></li><li class="chapter-item "><a href="../../../Language/Scala/测试和文档.html">测试和文档</a></li><li class="chapter-item "><a href="../../../Language/Scala/组合和继承.html">类的组合和继承</a></li></ol></li><li class="chapter-item "><a href="../../../Language/Snippet/index.html">Snippets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Language/Snippet/c.html">c</a></li><li class="chapter-item "><a href="../../../Language/Snippet/linux.html">linux</a></li><li class="chapter-item "><a href="../../../Language/Snippet/python.html">python</a></li><li class="chapter-item "><a href="../../../Language/Snippet/rust.html">rust</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../Tools/index.html">Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Tools/Docker.html">Docker</a></li><li class="chapter-item "><a href="../../../Tools/GDB.html">GDB</a></li><li class="chapter-item "><a href="../../../Tools/Git/index.html">Git</a></li><li class="chapter-item "><a href="../../../Tools/Git.html">Git</a></li><li class="chapter-item "><a href="../../../Tools/Githook.html">Githook</a></li><li class="chapter-item "><a href="../../../Tools/GithubCI.html">Github-CI</a></li><li class="chapter-item "><a href="../../../Tools/Latex.html">Latex</a></li><li class="chapter-item "><a href="../../../Tools/Make.html">Make与Makefile</a></li><li class="chapter-item "><a href="../../../Tools/VSCode.html">VSCode</a></li><li class="chapter-item "><a href="../../../Tools/Vim.html">Vim</a></li><li class="chapter-item "><a href="../../../Tools/WSL.html">WSL</a></li><li class="chapter-item "><a href="../../../Tools/双系统.html">双系统使用经历</a></li><li class="chapter-item "><a href="../../../Tools/软件打包.html">软件打包</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Reticence&#x27;s Notes</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="file-system"><a class="header" href="#file-system">File System</a></h1>
<p>这篇文章的目的是以Loadable Kernel Module的形式装载一个File System</p>
<ol>
<li>
<p>编写一个file system kernel module </p>
</li>
<li>
<p>载入module</p>
<pre><code class="language-sh">insmod myfs
</code></pre>
</li>
<li>
<p>把你想要hook file system的目录挂载到你自己的file system </p>
<pre><code class="language-sh">mount -t myfs /some/lower/path /mnt/wrapfs
</code></pre>
</li>
</ol>
<h2 id="virtual-file-system"><a class="header" href="#virtual-file-system">Virtual File System</a></h2>
<img src="../images/v2-b92499b17ed11bc279689ecdb6efb4b6_720w.jpg" alt="img" style="zoom:50%;" />
<p>关于VFS，有一篇<a href="https://www.kernel.org/doc/html/latest/filesystems/vfs.html#struct-file-system-type">不错的介绍</a>。这是2.6.39的代码，很简洁</p>
<pre><code class="language-c">struct file_system_type {
        const char *name;
        int fs_flags;
        struct dentry *(*mount) (struct file_system_type *, int,
                                 const char *, void *);
        void (*kill_sb) (struct super_block *);
        struct module *owner;
        struct file_system_type * next;
        struct list_head fs_supers;
        struct lock_class_key s_lock_key;
        struct lock_class_key s_umount_key;
};
</code></pre>
<h3 id="virtual-file-system-data-structure"><a class="header" href="#virtual-file-system-data-structure">Virtual File System Data Structure</a></h3>
<p>被称为文件系统的四大数据结构。无论底层的真实文件系统中是否有这些数据结构，在VFS中都会有对应的数据结构。</p>
<p><img src="../images/v2-1f4c58110d5c486d463308e01cb2b265_1440w.jpg" alt="img" /></p>
<p>超级块(<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/fs.h#L1465">struct super_block</a>)代表了整个文件系统，超级块是文件系统的控制块，有整个文件系统信息，一个文件系统所有的inode都要连接到超级块上，可以说，<strong>一个超级块就代表了一个文件系统</strong>。	</p>
<pre><code class="language-c">// 这个list上边的就是所有的在linux上记录的文件系统
struct list_head    s_list;		
// 挂载点
struct dentry		*s_root;
// 文件系统类型 也就是当前这个文件系统属于哪个类型 ext4/fat32
// 一个文件系统类型下可以包括很多文件系统即很多的super_block
struct file_system_type	*s_type;
// Filesystem private info 也就是说你可以在这里存一些你想要的自定义的东西
void			*s_fs_info;	
</code></pre>
<p>Inode(<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/fs.h#L623">struct inode</a>)保存的其实是实际的数据的一些信息，这些信息称为“元数据”(也就是对文件属性的描述)。例如：文件大小，设备标识符，用户标识符，用户组标识符，文件模式，扩展属性，文件读取或修改的时间戳，链接数量，指向存储该内容的磁盘区块的指针，文件分类等等。</p>
<pre><code class="language-c">// 这个就是我们平时看到的drwxrwxr-x的数据
umode_t            i_mode;
// 
union {
    struct hlist_head	i_dentry;
    struct rcu_head		i_rcu;
};
struct super_block	*i_sb;
// 这就是 inode numebr
unsigned long		i_ino;
// fs or device private pointer 也就是说你可以在这里存一些你想要的自定义的东西
void			*i_private; 
struct address_space	*i_mapping;
struct address_space	i_data;
</code></pre>
<p>目录项(<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/dcache.h#L91">struct dentry</a>)：目录项是<strong>描述文件</strong>的逻辑属性，只存在于内存中，并没有实际对应的磁盘上的描述，更确切的说是存在于内存的目录项缓存，为了提高查找性能而设计。注意<strong>不管是文件夹还是最终的文件</strong>，都是属于目录项，所有的目录项在一起构成一颗庞大的目录树。例如：open一个文件/home/xxx/yyy.txt，那么/、home、xxx、yyy.txt都是一个目录项，VFS在查找的时候，根据一层一层的目录项找到对应的每个目录项的inode，那么沿着目录项进行操作就可以找到最终的文件。</p>
<pre><code class="language-c">// small names 文件的名字，还有一个结构是d_name里面有一个指针指向了d_iname
unsigned char d_iname[DNAME_INLINE_LEN];	
// Where the name belongs to
struct inode *d_inode;	
// 对应的super_block
struct super_block *d_sb;	
// fs-specific data 也就是说你可以在这里存一些你想要的自定义的东西
void *d_fsdata;			
// 下面三个entry可以构成一个树形结构 
// list_head是一个双向链表,指向的是其他d_entry对应的list_head entry，然后再用hack的宏完成指向真正的d_entry
// (struct dentry*)((char *)me-&gt;d_child.head -(char *)&amp;((struct dentry *)0)-&gt;d_child))
// 对于非目录文件，d_subdirs 就指向他自己（这个entry）
struct dentry *d_parent;	/* parent directory 父 */
struct list_head d_child;	/* child of parent list 兄 */ 
struct list_head d_subdirs;	/* our children 子 */
</code></pre>
<p>文件对象(<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/fs.h#L965">struct file</a>)：注意文件对象描述的是进程已经打开的文件。因为一个文件可以被多个进程打开，所以一个文件可以存在多个文件对象。但是由于文件是唯一的，那么inode就是唯一的，目录项也是定的。<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/path.h#L8">struct path</a></p>
<pre><code class="language-c">// path是一个简单的结构体，里面有两项，其中一项就是dentry
struct path		f_path;
struct inode	*f_inode;	/* cached value */
// 一些flag规定文件的可读、可写、可执行权限
fmode_t			f_mode;
const struct file_operations	*f_op;
struct address_space	*f_mapping;
// 你可以在这里存一些你想要的自定义的东西
void			*private_data;
</code></pre>
<p>关于他们之间的转换：</p>
<ul>
<li>inode -&gt; dentry: 利用<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/list.h#L994"><code>hlist_for_each_entry</code></a>宏遍历<code>i_dentry</code>字段，可以参考Linux中的<a href="https://elixir.bootlin.com/linux/latest/source/fs/dcache.c#L666">一个例子</a>。</li>
<li>dentry -&gt; inode: 利用<a href="https://elixir.bootlin.com/linux/latest/source/include/linux/dcache.h#L303"><code>d_inode</code></a>函数，或者直接使用<code>d_inode</code>字段。</li>
<li>path -&gt; dentry: 利用<code>dentry</code>字段。</li>
<li>dentry -&gt; char *路径: 利用<a href="https://elixir.bootlin.com/linux/latest/source/fs/d_path.c#L371"><code>dentry_path</code></a>函数。</li>
<li>path -&gt; char *路径: 利用<a href="https://elixir.bootlin.com/linux/latest/source/fs/d_path.c#L264"><code>d_path</code></a>函数。</li>
<li>char *路径 -&gt; path: 利用kern_path函数。</li>
<li>superblock -&gt; inode: <a href="https://elixir.bootlin.com/linux/v4.20.17/source/fs/inode.c#L1137"><code>iget_locked</code></a>或者<a href="https://elixir.bootlin.com/linux/v4.20.17/source/fs/inode.c#L1097"><code>iget5_locked</code></a>。</li>
</ul>
<h3 id="virtual-file-system-operation"><a class="header" href="#virtual-file-system-operation">Virtual File System Operation</a></h3>
<p>虚拟文件系统是类似于Trait一样的东西，肯定是要暴露一些接口供真正的实现。在C语言中就是一堆函数指针，有下面这些方法(这些struct是一大堆方法的集合)</p>
<ul>
<li>
<p>file_system_type -&gt; <code>mount</code>: the method to call when a new instance of this filesystem should be mounted</p>
</li>
<li>
<p>file_system_type -&gt; <code>kill_sb</code>: the method to call when an instance of this filesystem should be shut down</p>
</li>
<li>
<p>super_block -&gt; <code>struct super_operations</code>: This describes how the VFS can manipulate the superblock of your filesystem</p>
<ul>
<li>statfs: </li>
</ul>
</li>
<li>
<p>inode -&gt; <code>struct inode_operations </code>: This describes how the VFS can manipulate an inode in your filesystem. </p>
</li>
<li>
<p>dentry -&gt; <code>struct dentry_operations</code>: This describes how a filesystem can overload the standard dentry operations.</p>
</li>
<li>
<p>file -&gt; <code>struct file_operations</code>: This describes how the VFS can manipulate an open file. </p>
</li>
<li>
<p>address_space -&gt;<code>struct address_space_operations</code>: This describes how the VFS can manipulate mapping of a file to page cache in your filesystem.</p>
</li>
</ul>
<p>所以这些方法都要重写吗？没有默认实现吗？并不是的，有些可以是NULL，表示不需要或者采用默认实现。<a href="https://www.kernel.org/doc/html/latest/filesystems/vfs.html#struct-file-system-type">这篇文章</a>提供了很好的参考，不过版本需要注意。</p>
<h3 id="mount"><a class="header" href="#mount">mount</a></h3>
<blockquote>
<p>mount [-t vfstype] [-o options] [设备名称] [挂载点]</p>
</blockquote>
<ul>
<li><code>挂载点</code>: 必须是一个已经存在的目录，这个目录可以不为空，但挂载后这个目录下以前的内容将不可用，umount以后会恢复正常</li>
<li><code>设备名称</code>: 可以是一个分区，一个usb设备，光驱，软盘，网络共享等</li>
<li><code>-t</code> 指定文件系统的类型，通常不必指定。mount 会自动选择正确的类型。常用类型有：</li>
</ul>
<p>从代码实现的角度，挂载的过程就是将代表这个文件系统的&quot;super_block&quot;结构体，加入由之前已经挂载的所有filesystems组成的双向链表中（即<code>s_list</code>）。</p>
<p>同一文件系统可以被挂载到多个mount point，这被称为&quot;bind mount&quot;（多个路径是bind在一起的）：</p>
<blockquote>
<p><strong>mount --bind &lt;old_directory&gt; &lt;new_directory&gt;</strong></p>
</blockquote>
<p>其实这并不难理解，它就像是文件系统层面的一个<strong>symbol link</strong>。</p>
<p>不同的文件系统也可以共用同一个mount point，新挂载的文件系统会<strong>覆盖</strong>掉这个位置之前的文件系统（覆盖，指暂时不可见，并不是把内容覆盖了）。</p>
<h3 id="rootfs"><a class="header" href="#rootfs">rootfs</a></h3>
<p>之前说挂载点必须是一个已存在的目录，所以<code>/</code>是怎么挂载上去的？蛋生鸡鸡生蛋？</p>
<p>rootfs就是所谓的根文件系统。Linux启动时，第一个必须挂载的是根文件系统，若系统不能从指定设备上挂载根文件系统，则系统会出错而退出启动。根文件系统包含系统启动时所必须的目录和关键性的文件</p>
<ol>
<li>init进程的应用程序必须运行在根文件系统上</li>
<li>根文件系统提供了根目录<code>/</code></li>
<li>linux挂载分区时所依赖的信息存放于根文件系统<code>/etc/fstab</code>这个文件中</li>
</ol>
<h3 id="分析inode的生命周期"><a class="header" href="#分析inode的生命周期">分析inode的生命周期</a></h3>
<ul>
<li><code>super_operations-&gt;alloc_inode</code>：this method is called by <code>alloc_inode()</code> to allocate memory for struct inode and initialize it. If this function is not defined, a simple ‘struct inode’ is allocated. Normally alloc_inode will be used to <strong>allocate a larger structure which contains a ‘struct inode’ embedded within it</strong>.</li>
<li>那么，什么地方调用了<code>alloc_inode</code>呢？有三个函数<code>new_inode_pseudo</code>,<code>iget5_locked</code>,<code>iget_locked</code>
<ul>
<li><code>new_inode_pseudo</code>是一个残废的函数，在<code>proc</code>这个仅存在于内存的文件系统中有使用。</li>
<li><code>iget5_locked</code>和<code>iget_locked</code>主要功能都是根据ino在super_block中找inode，不过<code>iget5_locked</code>可以带上回调函数。</li>
<li>研究ext2文件系统。<code>iget_locked</code>被<code>ext2_iget</code>调用。虽然有若干个场景使用了这个函数，我们重点关注的是<a href="https://elixir.bootlin.com/linux/v4.20.17/source/fs/ext2/namei.c#L56"><code>ext2_lookup</code></a>，他试图通过<code>ext2_inode_by_name</code>，通过dentry的路径信息，去寻找ino，然后再去寻找inode。</li>
</ul>
</li>
<li>所以，关键是<code>inode_operations-&gt;lookup</code>函数，这个函数实现了dentry到inode的转变，换句话说就是我们提供一个字符串路径，然后解析成dentry，再去lookup
<ul>
<li>lookup可能会找到已经在内存中的inode，还不在内存中的inode，或者硬盘上也没有的inode？</li>
<li>alloc_inode中会调用<code>inode_init_always</code>中会初始化inode的一些entry，在ext2_iget中会根据硬盘上的inode去初始化inode的一些entry。</li>
</ul>
</li>
<li><code>super_operations-&gt;destroy_inode</code>：this method is called by <code>destroy_inode()</code> to release resources allocated for struct inode. It is only required if <code>-&gt;alloc_inode</code> was defined and simply undoes anything done by <code>-&gt;alloc_inode</code>.</li>
</ul>
<p>归纳一下，路径 -&gt; filename_lookup -&gt; ext4_lookup(在这里会根据文件名查ino) -&gt; ext4_iget -&gt; iget_locked(ino -&gt; inode) -&gt; alloc_inode(分配内存，初始化)</p>
<pre><code>#0  alloc_inode (sb=0xffff888006106800) at fs/inode.c:226
#1  0xffffffff812ebe9e in iget_locked (sb=0xffff888006106800, ino=0x134) at fs/inode.c:1192
#2  0xffffffff81399ee0 in __ext4_iget (sb=0xffff888006106800, ino=0x134, flags=&lt;optimized out&gt;, function=0xffffffff82081c00 &lt;__func__.72414&gt; &quot;ext4_lookup&quot;, line=&lt;optimized out&gt;) at fs/ext4/inode.c:4878
#3  0xffffffff813b2bf7 in ext4_lookup (flags=&lt;optimized out&gt;, dentry=&lt;optimized out&gt;, dir=&lt;optimized out&gt;) at fs/ext4/namei.c:1701
#4  ext4_lookup (dir=0xffff8880066e1a98, dentry=0xffff88800673dd80, flags=&lt;optimized out&gt;) at fs/ext4/namei.c:1676
#5  0xffffffff812d7ee2 in __lookup_slow (name=0xffffc90000393cf0, dir=0xffff8880066d5000, flags=0x1) at fs/namei.c:1664
#6  0xffffffff812d7feb in lookup_slow (name=0xffffc90000393cf0, dir=0xffff8880066d5000, flags=0x1) at fs/namei.c:1681
#7  0xffffffff812d81ea in walk_component (nd=0xffffc90000393ce0, flags=0x0) at fs/namei.c:1801
#8  0xffffffff812d90d0 in lookup_last (nd=&lt;optimized out&gt;) at fs/namei.c:2264
#9  path_lookupat (nd=0xffffc90000393ce0, flags=0x0, path=&lt;optimized out&gt;) at fs/namei.c:2309
#10 0xffffffff812ddb3e in filename_lookup (dfd=&lt;optimized out&gt;, name=0xffff8880075f1000, flags=0x1, path=0xffffc90000393e30, root=&lt;optimized out&gt;) at fs/namei.c:2339
#11 0xffffffff812ddcea in user_path_at_empty (dfd=0xffffff9c, name=&lt;optimized out&gt;, flags=0x1, path=0xffffc90000393e30, empty=&lt;optimized out&gt;) at fs/namei.c:2599
#12 0xffffffff812d033d in user_path_at (path=&lt;optimized out&gt;, flags=&lt;optimized out&gt;, name=&lt;optimized out&gt;, dfd=&lt;optimized out&gt;) at ./include/linux/namei.h:49
#13 vfs_statx (dfd=0xffffff9c, filename=0x555f6ae2e8e0 &quot;local&quot;, flags=0x800, stat=&lt;optimized out&gt;, request_mask=0x7ff) at fs/stat.c:187
#14 0xffffffff812d093e in vfs_stat (stat=&lt;optimized out&gt;, filename=&lt;optimized out&gt;) at ./include/linux/fs.h:3253
#15 __do_sys_newstat (filename=&lt;optimized out&gt;, statbuf=0x7ffd5ddbc3c0) at fs/stat.c:341
#16 0xffffffff812d0996 in __se_sys_newstat (statbuf=&lt;optimized out&gt;, filename=&lt;optimized out&gt;) at fs/stat.c:337
#17 __x64_sys_newstat (regs=&lt;optimized out&gt;) at fs/stat.c:337
#18 0xffffffff81004017 in do_syscall_64 (nr=&lt;optimized out&gt;, regs=0xffffc90000393f58) at arch/x86/entry/common.c:290
#19 0xffffffff81c0008c in entry_SYSCALL_64 () at arch/x86/entry/entry_64.S:175
</code></pre>
<h2 id="内核读写文件"><a class="header" href="#内核读写文件">内核读写文件</a></h2>
<p>Since version 4.14 of Linux kernel, <code>vfs_read</code> and <code>vfs_write</code> functions are <strong>no longer exported</strong> for use in modules. Instead, functions exclusively for kernel's file access are provided:</p>
<pre><code class="language-c"># Read the file from the kernel space.
ssize_t kernel_read(struct file *file, void *buf, size_t count, loff_t *pos);

# Write the file from the kernel space.
ssize_t kernel_write(struct file *file, const void *buf, size_t count,
            loff_t *pos);
</code></pre>
<p>Also, <code>filp_open</code> no longer accepts user-space string, so it can be used for kernel access <strong>directly</strong> (without dance with <code>set_fs</code>).</p>
<p>打开文件，可以参考一个<a href="https://elixir.bootlin.com/linux/v4.20.17/source/drivers/target/target_core_file.c#L134">驱动的例子</a>。</p>
<h2 id="registering-and-mounting-a-filesystem"><a class="header" href="#registering-and-mounting-a-filesystem">Registering and Mounting a Filesystem</a></h2>
<p>这是用于注册file system type的接口。</p>
<pre><code class="language-c">extern int register_filesystem(struct file_system_type *);
extern int unregister_filesystem(struct file_system_type *);
</code></pre>
<p>一般的，我们可以定义一个我们<code>file_system_type</code>然后注册他。虽然它有很多字段，但是看起来下面的字段是必须的，代码来自<a href="https://elixir.bootlin.com/linux/latest/source/fs/ext4/super.c#L116">5.17</a></p>
<pre><code class="language-c">static struct file_system_type ext2_fs_type = {
	.owner		= THIS_MODULE,
	.name		= &quot;ext2&quot;,
	.mount		= ext4_mount,
	.kill_sb	= kill_block_super,
	.fs_flags	= FS_REQUIRES_DEV,
};
</code></pre>
<p>上面我们提到了，<code>mount</code>和<code>kill_sb</code>是“接口”，也就是函数指针。我们应该怎么去实现他们呢？参考一些代码，一般来说，会是简单封装下面几个函数之一，<a href="https://elixir.bootlin.com/linux/latest/source/fs/ext4/super.c#L6511"><code>ext4_mount</code></a>就是对<code>mount_bdev</code>的简单封装。</p>
<pre><code class="language-c">extern struct dentry *mount_bdev(struct file_system_type *fs_type,
	int flags, const char *dev_name, void *data,
	int (*fill_super)(struct super_block *, void *, int));
extern struct dentry *mount_single(struct file_system_type *fs_type,
	int flags, void *data,
	int (*fill_super)(struct super_block *, void *, int));
extern struct dentry *mount_nodev(struct file_system_type *fs_type,
	int flags, void *data,
	int (*fill_super)(struct super_block *, void *, int));
</code></pre>
<p>参照<code>ext4_mount</code>的代码。所以，看起来<code>fill_super</code>函数的实现才是重点所在。</p>
<p>我们之前提到，每个挂载的文件系统和<code>super_block</code>是一一对应的。顾名思义<code>fill_super</code>就是装填<code>super_block</code>。他的三个参数分别是</p>
<ul>
<li><code>struct super_block *sb</code> the superblock structure. The callback must initialize this properly.</li>
<li><code>void *data</code> arbitrary mount options, usually comes as an ASCII string (see “Mount Options” section)</li>
<li><code>int silent</code> whether or not to be silent on error</li>
</ul>
<h2 id="fs_struct和files_struct"><a class="header" href="#fs_struct和files_struct">fs_struct和files_struct</a></h2>
<p>顺带一提，<code>task_struct</code>中有两个结构</p>
<pre><code class="language-c">/* Filesystem information: */
struct fs_struct		*fs;
/* Open file information: */
struct files_struct		*files;
</code></pre>
<p>我们常说的<strong>打开文件表</strong>指的是后者，<code>files_struct -&gt; fdt</code>指向了打开文件表，<code>fdtable -&gt; fd</code>是一个<code>file</code>数组。我们获得的<strong>文件描述符</strong>其实就是这个数组的下标，<code>fd[fd]</code>就是一个<code>file *</code>类型。</p>
<pre><code class="language-c">// include/linux/fdtable.h of linux-2.6.37
struct files_struct {
  /*
   * read mostly part
   */
        atomic_t count;
        struct fdtable __rcu *fdt;
        struct fdtable fdtab;
  /*
   * written part on a separate cache line in SMP
   */
        spinlock_t file_lock ____cacheline_aligned_in_smp;
        int next_fd;
        struct embedded_fd_set close_on_exec_init;
        struct embedded_fd_set open_fds_init;
        struct file __rcu * fd_array[NR_OPEN_DEFAULT];
};

struct fdtable {
        unsigned int max_fds;
        struct file __rcu **fd;      /* current fd array */
        fd_set *close_on_exec;
        fd_set *open_fds;
        struct rcu_head rcu;
        struct fdtable *next;
};
</code></pre>
<p>数据结构示意图如下，转载自知乎的陈硕大佬。</p>
<p><img src="../images/v2-d9ef0e73add79e1e8c0330fe9ca30420_720w.jpg" alt="img" /></p>
<p>一个迷惑的点是<code>fdtab</code>和<code>fdt</code>有什么区别？为什么一个结构里有两个表？我看到一个解释是下面这样的，调试的时候发现有时<code>fdt</code>并不指向<code>fdtab</code>，有时确实是一个东西。</p>
<blockquote>
<p>为什么有两个fdtable呢？这是内核的一种优化策略。fdt为指针，而fdtab为普通变量。一般情况下，fdt是指向fdtab的，当需要它的时候，才会真正动态申请内存。因为默认大小的文件表足以应付大多数情况，大多数进程不会打开很多的文件，因此这样就可以避免频繁的内存申请。这也是内核的常用技巧之一。在创建时, 使用普通的变量或者数组，然后让指针指向它，作为默认情况使用。只有当进程使用量超过默认值时，才会动态申请内存。</p>
</blockquote>
<h2 id="分析open系统调用"><a class="header" href="#分析open系统调用">分析open系统调用</a></h2>
<p><code>open</code>, <code>openat</code>, <code>creat</code> 都可以起到打开一个文件的作用。他们是不同的系统调用，不过真正的执行的代码是差不多的，进过一些检查，最后调用<a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/open.c#L1079"><code>do_sys_open()</code></a>。</p>
<pre><code class="language-c">long do_sys_open(int dfd, const char __user *filename, int flags,
                 umode_t mode);
// dfd: dirfd
// filename
// flags
// mode
</code></pre>
<p>阅读<a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/open.c#L1079"><code>do_sys_open()</code></a>源代码，执行流程大致如下（先忽略flags）：</p>
<ul>
<li>先调用<code>getname</code>， 主要功能是在使用文件名之前将其拷贝到内核数据区，正常结束时返回内核分配的空间首地址。</li>
<li>在调用<code>get_unused_fd_flags</code>，顾名思义是取得系统中可用的文件描述符fd。</li>
<li>然后是重头戏，<code>struct file *f = do_filp_open(dfd, tmp, &amp;op);</code></li>
<li><code>fd_install</code>，感觉是把<code>f</code>存下来，再把<code>fd</code>和<code>f</code>关联起来。</li>
</ul>
<p>阅读<a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/namei.c#L3550"><code>do_filp_open()</code></a>源代码。</p>
<ul>
<li><code>set_nameidata</code>: 调用 <code>set_nameidata()</code> 保护当前进程现场信息，<strong><code>nameidata</code>这个结构用来辅助路径查找</strong>。</li>
<li>然后是重头戏，<code>filp = path_openat(&amp;nd, op, flags | LOOKUP_RCU);</code></li>
<li><code>restore_nameidata</code></li>
</ul>
<p>阅读<a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/namei.c#L3511"><code>path_openat()</code></a>源代码。重点关注忽略了所有失败情况的下面的代码</p>
<pre><code class="language-c">file = alloc_empty_file(op-&gt;open_flag, current_cred());

const char *s = path_init(nd, flags);
while (!(error = link_path_walk(s, nd)) &amp;&amp;
       (error = do_last(nd, file, op)) &gt; 0) {
    nd-&gt;flags &amp;= ~(LOOKUP_OPEN|LOOKUP_CREATE|LOOKUP_EXCL);
    s = trailing_symlink(nd);
}
terminate_walk(nd);

return file;
</code></pre>
<h2 id="利用wrapfs管理权限"><a class="header" href="#利用wrapfs管理权限">利用Wrapfs管理权限</a></h2>
<p>限制文件读写：</p>
<ul>
<li>
<p>从<code>file_operations.read</code>和<code>file_operations.write</code>入手，并不好使，具体原因有待进一步发现。（可能是<code>file_operations.read_iter</code>和<code>file_operations.write_iter</code>的关系。因为就现在的文件系统，大部分都实现了后两者而不是前两者。）</p>
</li>
<li>
<p>从<code>inode_operations.permission</code>入手，相当于是可以动态的修改一个文件的<code>rwx</code>权限了，这样确实可以对读写进行有效控制，但是阻止不了移动、删除，因为移动和删除相当于是目录的权限管理了。</p>
</li>
<li>
<p>从<code>inode_operations.fileattr_get</code>入手（还有一个很具有迷惑性的方法<code>getattr</code>）(4.4没有这个方法！)</p>
</li>
<li>
<p>从<code>file_operations.unlocked_ioctl</code>和<code>file_operations.compat_ioctl</code>入手，结果发现在修改一个被我加了<code>i</code>属性的文件时根本没有调用过，只在<code>lsattr</code>的时候会调用，奇怪。</p>
<ul>
<li>
<p>跟踪发现是<code>faccessat</code>这个调用族做的检查</p>
<pre><code>faccessat(AT_FDCWD, &quot;aaa&quot;, W_OK)  = -1 EPERM (Operation not permitted)
faccessat(AT_FDCWD, &quot;aaa&quot;, W_OK)  = 0
</code></pre>
<p>源代码https://elixir.bootlin.com/linux/v4.4.295/source/fs/open.c#L337</p>
</li>
</ul>
</li>
<li>
<p>考虑<code>inode_operations.rename</code>和<code>inode_operations.unlink</code>.  因为跟踪发现他们和文件的移动和删除密切相关，用<code>strace</code>跟踪mv和rm的执行。</p>
<pre><code>mv =&gt; renameat2(AT_FDCWD, &quot;../i.md&quot;, AT_FDCWD, &quot;../i1.md&quot;, RENAME_NOREPLACE) = 0
rm =&gt; unlinkat(AT_FDCWD, &quot;aaa&quot;, 0)      = 0
</code></pre>
</li>
</ul>
<p>总结：从<code>permission</code>,<code>rename</code>,<code>unlink</code>入手。</p>
<h3 id="执行权限"><a class="header" href="#执行权限">执行权限</a></h3>
<p>以Linux5.4为例，跟踪<code>inode_permission</code>函数在<code>execve</code>的何时被调用进行权限检查。</p>
<pre><code class="language-c">[#0] 0xffffffff812d8690 → inode_permission(inode=0xffff8880064f1650, mask=0x81)
[#1] 0xffffffff812d8aed → may_lookup(nd=&lt;optimized out&gt;)
[#2] 0xffffffff812d8aed → link_path_walk(name=0xffff888004ce2021 &quot;bin/ls&quot;, nd=0xffffc9000020fd10)
[#3] 0xffffffff812db4c6 → link_path_walk(nd=&lt;optimized out&gt;, name=&lt;optimized out&gt;)
[#4] 0xffffffff812db4c6 → path_openat(nd=0xffffc9000020fd10, op=0xffffc9000020fe24, flags=&lt;optimized out&gt;)
[#5] 0xffffffff812ddfa1 → do_filp_open(dfd=&lt;optimized out&gt;, pathname=&lt;optimized out&gt;, op=0xffffc9000020fe24)
[#6] 0xffffffff812d16a7 → do_open_execat(fd=&lt;optimized out&gt;, name=0xffff888004ce2000, flags=&lt;optimized out&gt;)
[#7] 0xffffffff812d35c8 → __do_execve_file(fd=&lt;optimized out&gt;, filename=0xffff888004ce2000, flags=0x0, file=0x0 &lt;fixed_percpu_data&gt;, argv=&lt;optimized out&gt;, envp=&lt;optimized out&gt;)
[#8] 0xffffffff812d39a9 → do_execveat_common(flags=&lt;optimized out&gt;, filename=&lt;optimized out&gt;, fd=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, envp=&lt;optimized out&gt;)
[#9] 0xffffffff812d39a9 → do_execve(__envp=&lt;optimized out&gt;, __argv=&lt;optimized out&gt;, filename=&lt;optimized out&gt;)
</code></pre>
<h3 id="添加权限字段"><a class="header" href="#添加权限字段">添加权限字段</a></h3>
<p>怎么向<code>inode</code>结构添加东西呢？</p>
<ul>
<li>
<p>inode的诞生：<code>super_operations-&gt;alloc_inode</code>: this method is called by <a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/inode.c#L225"><code>alloc_inode()</code> </a> to allocate memory for struct inode and initialize it. If this function is not defined, a simple ‘struct inode’ is allocated. Normally <code>alloc_inode</code> will be used to <strong>allocate a larger structure which contains a ‘struct inode’ embedded within it.</strong></p>
<p>我们定制他来产生<code>wrapfs_inode</code></p>
<p><code>&lt;fsname_iget&gt;</code>: 从设备中读取inode</p>
</li>
<li>
<p>inode的使用，从场景出发</p>
<ul>
<li>用户如果需要使用一个文件，他会使用<code>open</code>系列的系统调用，得到一个文件描述符。对于kernel来说，我们产生了一个<code>file</code>代表打开的文件，在上面介绍的进程的<code>files</code>字段中会存储所有打开的文件。之后的读写就针对<code>file</code>进行。</li>
<li>所以<code>open</code>是怎么找到<code>inode</code>的呢？简单的说，根据路径进行遍历。</li>
</ul>
</li>
<li>
<p>inode的回收：<code>super_operations-&gt;destroy_inode</code>: this method is called by <a href="https://elixir.bootlin.com/linux/v5.4.168/source/fs/inode.c#L274"><code>destroy_inode()</code> </a> to release resources allocated for struct inode. It is only required if <code>super_operations-&gt;alloc_inode</code> was defined and simply undoes anything done by <code>super_operations-&gt;alloc_inode</code>.</p>
</li>
<li>
<p>由于我们的文件系统是完全存在于内存的，可以忽略inode的dirty，write等和设备同步的操作。</p>
</li>
</ul>
<h3 id="和用户交换信息"><a class="header" href="#和用户交换信息">和用户交换信息</a></h3>
<p>从用户获得的信息最好是<code>filename</code> + <code>permission</code>。利用 <code>kern_path()</code>函数可以根据文件名获得<code>struct path</code>，里面有<code>mnt</code>还有<code>dentry</code>，这样拿到对应的inode就不是问题。</p>
<p>发送给用户的信息可以是<code>uuid+inode</code>，或者可以利用<code>inode</code>中的<code>i_dentry</code>链表选择一个文件名来保护，反正最后的权限会落到inode。</p>
<h2 id="fuse"><a class="header" href="#fuse">FUSE</a></h2>
<p><a href="https://man7.org/linux/man-pages/man4/fuse.4.html">fuse - Filesystem in Userspace (FUSE) device.</a></p>
<p>这个模型可以让你<strong>在User Level</strong>实现文件系统，原理大致是Kernel作为Client，而你的进程（往往是Daemon）作为Server，双方进行通信，你可以Hook一些操作。有一个Python的API绑定。</p>
<pre><code class="language-sh">sudo apt install libfuse3-dev fuse3
pip3 install pyfuse3
</code></pre>
<hr />
<p>https://www.kernel.org/doc/html/latest/filesystems/vfs.html#struct-file-system-type</p>
<p>https://zhuanlan.zhihu.com/p/34280875	</p>
<p>https://bean-li.github.io/vfs-inode-dentry/</p>
<p><a href="https://juejin.cn/post/6844903926735568904">解析open调用的系列文章，挺好的</a></p>
<p><a href="https://stackoverflow.com/questions/1184274/read-write-files-within-a-linux-kernel-module">内核如何读写文件</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../Advanced/Linux/LinuxKernel/Debug笔记.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../../Advanced/Linux/LinuxKernel/Linux内核设计与实现笔记.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../Advanced/Linux/LinuxKernel/Debug笔记.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../Advanced/Linux/LinuxKernel/Linux内核设计与实现笔记.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
